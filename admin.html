<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - News263 Harare</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Fetch and render articles from the backend
    async function fetchArticles() {
      const response = await fetch('http://localhost:5000/api/articles');
      const articles = await response.json();

      const articlesList = document.getElementById('articles-list');
      articlesList.innerHTML = ''; // Clear the list

      articles.forEach(article => {
        const articleItem = `
          <li class="bg-white shadow-md rounded-lg p-4 flex items-center space-x-4" data-id="${article._id}">
            <img src="${article.image}" alt="${article.title}" class="w-32 h-32 object-cover rounded-md">
            <div>
              <h4 class="text-lg font-bold">${article.title}</h4>
              <p class="text-gray-700">${article.content.substring(0, 100)}...</p>
              <div class="mt-2 flex space-x-4">
                <button onclick="deleteArticle('${article._id}')" class="bg-red-600 text-white py-1 px-3 rounded-md hover:bg-red-700">Delete</button>
                <button onclick="editArticle('${article._id}', '${article.title}', '${article.image}', '${article.content}')" class="bg-green-600 text-white py-1 px-3 rounded-md hover:bg-green-700">Edit</button>
              </div>
            </div>
          </li>
        `;
        articlesList.insertAdjacentHTML('beforeend', articleItem);
      });
    }

    // Add a new article
    async function addArticle(event) {
      event.preventDefault();

      const title = document.getElementById('title').value;
      const image = document.getElementById('image').value;
      const content = document.getElementById('content').value;

      await fetch('http://localhost:5000/api/articles', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, image, content }),
      });

      document.getElementById('title').value = '';
      document.getElementById('image').value = '';
      document.getElementById('content').value = '';

      fetchArticles(); // Refresh the article list
    }

    // Delete an article
    async function deleteArticle(id) {
      await fetch(`http://localhost:5000/api/articles/${id}`, { method: 'DELETE' });
      fetchArticles(); // Refresh the article list
    }

    // Edit an article
    async function editArticle(id, title, image, content) {
      document.getElementById('title').value = title;
      document.getElementById('image').value = image;
      document.getElementById('content').value = content;

      const submitButton = document.querySelector('form button');
      submitButton.textContent = 'Update Article';
      submitButton.onclick = async function (event) {
        event.preventDefault();

        const updatedTitle = document.getElementById('title').value;
        const updatedImage = document.getElementById('image').value;
        const updatedContent = document.getElementById('content').value;

        await fetch(`http://localhost:5000/api/articles/${id}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title: updatedTitle, image: updatedImage, content: updatedContent }),
        });

        submitButton.textContent = 'Publish Article';
        submitButton.onclick = addArticle;

        document.getElementById('title').value = '';
        document.getElementById('image').value = '';
        document.getElementById('content').value = '';

        fetchArticles(); // Refresh the article list
      };
    }

    // Initial fetch on page load
    document.addEventListener('DOMContentLoaded', fetchArticles);
  </script>
</head>
<body class="bg-gray-100">
  <!-- Header -->
  <header class="bg-red-900 text-black font-bold py-4">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-3xl font-bold">
        <span class="text-black">News</span><span class="text-red-600">2</span><span class="text-yellow-500">6</span><span class="text-green-600">3</span>
        <span class="text-black"> Harare</span>
      </h1> 
      <nav class="space-x-4">
        <a href="index.html" class="hover:underline">Home</a>
        <a href="about.html" class="hover:underline">About</a>
        <a href="categories.html" class="hover:underline">Categories</a>
        <a href="contact.html" class="hover:underline">Contact</a>
        <a href="admin.html" class="hover:underline">Admin</a>
      </nav>
    </div>
  </header>

  <!-- Main Content (Admin Page) -->
  <main class="container mx-auto my-6 px-4">
    <h2 class="text-2xl font-bold mb-6">Admin Panel</h2>

    <!-- Form to Add/Edit News -->
    <section class="mb-10">
      <h3 class="text-xl font-bold mb-4">Add/Edit Article</h3>
      <form class="bg-white shadow-md rounded-lg p-6 space-y-4" onsubmit="addArticle(event)">
        <div>
          <label for="title" class="block text-gray-700 font-bold mb-2">News Title</label>
          <input type="text" id="title" class="w-full p-3 border rounded-md" placeholder="Enter news title" required>
        </div>
        <div>
          <label for="image" class="block text-gray-700 font-bold mb-2">Image URL</label>
          <input type="url" id="image" class="w-full p-3 border rounded-md" placeholder="Enter image URL">
        </div>
        <div>
          <label for="content" class="block text-gray-700 font-bold mb-2">Content</label>
          <textarea id="content" rows="5" class="w-full p-3 border rounded-md" placeholder="Enter the news content" required></textarea>
        </div>
        <button type="submit" class="bg-red-900 text-white py-2 px-4 rounded-md hover:bg-blue-800">
          Publish Article
        </button>
      </form>
    </section>

    <!-- List of Articles -->
    <section>
      <h3 class="text-xl font-bold mb-4">Manage Articles</h3>
      <ul id="articles-list" class="space-y-4">
        <!-- Articles will be dynamically loaded here -->
      </ul>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-red-900 text-black py-4">
    <div class="container mx-auto text-center px-4">
      <p>&copy; 2025 News263 Harare. All Rights Reserved.</p>
    </div>
    <div class="flex justify-center mt-4 space-x-4">
      <!-- Facebook Icon -->
      <a href="" target="_blank" aria-label="Facebook">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-6 h-6">
          <path fill="#1877F2" d="M22.675 0H1.325C.593 0 0 .593 0 1.325v21.351C0 23.407.593 24 1.325 24h11.483v-9.294H9.692v-3.622h3.116V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.794.143v3.243l-1.917.001c-1.504 0-1.795.715-1.795 1.763v2.311h3.587l-.467 3.622h-3.12V24h6.116c.729 0 1.325-.593 1.325-1.325V1.325C24 .593 23.407 0 22.675 0z" />
          <path fill="#FFF" d="M16.322 24v-9.294h3.12l.467-3.622h-3.587V8.772c0-1.048.291-1.763 1.795-1.763l1.917-.001V3.765c-.331-.044-1.469-.143-2.794-.143-2.766 0-4.659 1.688-4.659 4.788v2.659H9.692v3.622h3.116V24h3.514z" />
        </svg>
      </a>
      <!-- Instagram Icon -->
      <a href="" target="_blank" aria-label="Instagram">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-6 h-6">
          <linearGradient id="a" x1="12" x2="12" y1="2" y2="22.001" gradientUnits="userSpaceOnUse">
            <stop offset="0" stop-color="#f09433" />
            <stop offset="0.25" stop-color="#e6683c" />
            <stop offset="0.5" stop-color="#dc2743" />
            <stop offset="0.75" stop-color="#cc2366" />
            <stop offset="1" stop-color="#bc1888" />
          </linearGradient>
          <path fill="url(#a)" d="M12 2c2.829 0 3.172.012 4.294.062 1.118.05 1.885.229 2.635.488a5.57 5.57 0 012.032 1.316 5.57 5.57 0 011.316 2.032c.259.75.438 1.517.488 2.635.05 1.122.062 1.465.062 4.294s-.012 3.172-.062 4.294c-.05 1.118-.229 1.885-.488 2.635a5.57 5.57 0 01-1.316 2.032 5.57 5.57 0 01-2.032 1.316c-.75.259-1.517.438-2.635.488-1.122.05-1.465.062-4.294.062s-3.172-.012-4.294-.062c-1.118-.05-1.885-.229-2.635-.488a5.57 5.57 0 01-2.032-1.316 5.57 5.57 0 01-1.316-2.032c-.259-.75-.438-1.517-.488-2.635C2.012 15.172 2 14.829 2 12s.012-3.172.062-4.294c.05-1.118.229-1.885.488-2.635a5.57 5.57 0 011.316-2.032 5.57 5.57 0 012.032-1.316c.75-.259 1.517-.438 2.635-.488C8.828 2.012 9.171 2 12 2m0-2C8.726 0 8.358.012 7.128.062c-1.236.052-2.08.231-2.84.488a7.57 7.57 0 00-2.767 1.795A7.57 7.57 0 00.551 5.102c-.257.76-.436 1.604-.488 2.84C0 8.358 0 8.726 0 12c0 3.274.012 3.642.062 4.872.052 1.236.231 2.08.488 2.84a7.57 7.57 0 001.795 2.767 7.57 7.57 0 002.767 1.795c.76.257 1.604.436 2.84.488C8.358 24 8.726 24 12 24c3.274 0 3.642-.012 4.872-.062 1.236-.052 2.08-.231 2.84-.488a7.57 7.57 0 002.767-1.795 7.57 7.57 0 001.795-2.767c.257-.76.436-1.604.488-2.84C24 15.642 24 15.274 24 12c0-3.274-.012-3.642-.062-4.872-.052-1.236-.231-2.08-.488-2.84a7.57 7.57 0 00-1.795-2.767A7.57 7.57 0 0019.712.551c-.76-.257-1.604-.436-2.84-.488C15.642 0 15.274 0 12 0z" />
          <path fill="#FFF" d="M12 5.838A6.162 6.162 0 1112 18.163 6.162 6.162 0 0112 5.838zm0 10.164a4.002 4.002 0 100-8.003 4.002 4.002 0 000 8.003zm6.406-10.845a1.44 1.44 0 11-2.88 0 1.44 1.44 0 012.88 0z" />
        </svg>
      </a>
    </div>
  </footer>
</body>
</html>
